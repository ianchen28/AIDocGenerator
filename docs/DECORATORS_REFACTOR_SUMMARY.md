# è£…é¥°å™¨æ¨¡å—é‡æž„æ€»ç»“

## ðŸ“‹ æ¦‚è¿°

å°†åŽŸæœ¬åˆ†æ•£åœ¨å„ä¸ªæ¨¡å—ä¸­çš„è£…é¥°å™¨å‡½æ•°ç»Ÿä¸€é‡æž„åˆ°ä¸“é—¨çš„è£…é¥°å™¨å·¥å…·æ¨¡å—ä¸­ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¤ç”¨æ€§ã€‚

## ðŸ”§ é‡æž„å†…å®¹

### 1. åˆ›å»ºæ–°çš„è£…é¥°å™¨æ¨¡å—

**æ–‡ä»¶**: `service/src/doc_agent/utils/decorators.py`

**åŒ…å«çš„è£…é¥°å™¨**:
- `timer`: è®¡ç®—å‡½æ•°æ‰§è¡Œæ—¶é—´
- `retry`: é‡è¯•æœºåˆ¶
- `cache_result`: ç»“æžœç¼“å­˜
- `log_function_call`: å‡½æ•°è°ƒç”¨æ—¥å¿—
- `validate_input`: è¾“å…¥éªŒè¯

### 2. æ›´æ–°å·¥å…·æ¨¡å—

**æ–‡ä»¶**: `service/src/doc_agent/utils/__init__.py`

**å˜æ›´**:
- æ·»åŠ äº†è£…é¥°å™¨æ¨¡å—çš„å¯¼å…¥
- æ›´æ–°äº† `__all__` åˆ—è¡¨

### 3. é‡æž„ web_search.py

**æ–‡ä»¶**: `service/src/doc_agent/tools/web_search.py`

**å˜æ›´**:
- ç§»é™¤äº†åŽŸæœ‰çš„ `timer` è£…é¥°å™¨å®šä¹‰
- æ·»åŠ äº†ä»Ž `doc_agent.utils.decorators` å¯¼å…¥ `timer` çš„è¯­å¥
- ç§»é™¤äº†ä¸å†éœ€è¦çš„ `functools` å¯¼å…¥

## ðŸŽ¯ é‡æž„ä¼˜åŠ¿

### 1. **ä»£ç ç»„ç»‡æ›´æ¸…æ™°**
- è£…é¥°å™¨å‡½æ•°é›†ä¸­ç®¡ç†
- é¿å…ä»£ç é‡å¤
- ä¾¿äºŽç»´æŠ¤å’Œæ›´æ–°

### 2. **æé«˜å¤ç”¨æ€§**
- å…¶ä»–æ¨¡å—å¯ä»¥ç›´æŽ¥å¯¼å…¥ä½¿ç”¨
- ç»Ÿä¸€çš„è£…é¥°å™¨æŽ¥å£
- æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥å‡½æ•°

### 3. **å¢žå¼ºåŠŸèƒ½**
- æ–°å¢žäº†å¤šä¸ªå®žç”¨çš„è£…é¥°å™¨
- æ›´å¥½çš„é”™è¯¯å¤„ç†
- æ›´çµæ´»çš„é…ç½®é€‰é¡¹

## ðŸ“ è£…é¥°å™¨ä½¿ç”¨ç¤ºä¾‹

### Timer è£…é¥°å™¨
```python
from doc_agent.utils.decorators import timer

@timer
def sync_function():
    # åŒæ­¥å‡½æ•°
    pass

@timer(log_level="debug")
async def async_function():
    # å¼‚æ­¥å‡½æ•°
    pass
```

### Retry è£…é¥°å™¨
```python
from doc_agent.utils.decorators import retry

@retry(max_attempts=3, delay=1.0)
def unreliable_function():
    # å¯èƒ½å¤±è´¥çš„å‡½æ•°
    pass
```

### Cache è£…é¥°å™¨
```python
from doc_agent.utils.decorators import cache_result

@cache_result(ttl=300)  # ç¼“å­˜5åˆ†é’Ÿ
def expensive_function(x):
    # æ˜‚è´µçš„è®¡ç®—
    return x * x
```

### Log è£…é¥°å™¨
```python
from doc_agent.utils.decorators import log_function_call

@log_function_call(log_args=True, log_result=True)
def important_function(x, y):
    return x + y
```

### Validate è£…é¥°å™¨
```python
from doc_agent.utils.decorators import validate_input

@validate_input(lambda x: x > 0, lambda x: x < 100)
def process_number(x):
    return x * 2
```

## ðŸ§ª æµ‹è¯•éªŒè¯

åˆ›å»ºäº† `test_decorators.py` æµ‹è¯•æ–‡ä»¶ï¼ŒéªŒè¯æ‰€æœ‰è£…é¥°å™¨çš„åŠŸèƒ½ï¼š

- âœ… Timer è£…é¥°å™¨ï¼ˆåŒæ­¥/å¼‚æ­¥ï¼‰
- âœ… Retry è£…é¥°å™¨ï¼ˆé‡è¯•æœºåˆ¶ï¼‰
- âœ… Cache è£…é¥°å™¨ï¼ˆç»“æžœç¼“å­˜ï¼‰
- âœ… Log è£…é¥°å™¨ï¼ˆè°ƒç”¨æ—¥å¿—ï¼‰
- âœ… Validate è£…é¥°å™¨ï¼ˆè¾“å…¥éªŒè¯ï¼‰
- âœ… å¼‚æ­¥è£…é¥°å™¨ç»„åˆä½¿ç”¨

## ðŸ“ æ–‡ä»¶ç»“æž„

```
service/src/doc_agent/utils/
â”œâ”€â”€ __init__.py          # æ›´æ–°äº†å¯¼å…¥
â”œâ”€â”€ decorators.py        # æ–°å¢žï¼šè£…é¥°å™¨æ¨¡å—
â”œâ”€â”€ content_processor.py # çŽ°æœ‰
â””â”€â”€ search_utils.py      # çŽ°æœ‰
```

## ðŸ”„ è¿ç§»æŒ‡å—

### å¯¹äºŽçŽ°æœ‰ä»£ç 

å¦‚æžœå…¶ä»–æ¨¡å—ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„è£…é¥°å™¨ï¼Œå»ºè®®ï¼š

1. **è¯†åˆ«é‡å¤ä»£ç **: æŸ¥æ‰¾é¡¹ç›®ä¸­çš„è£…é¥°å™¨å®šä¹‰
2. **ç»Ÿä¸€å¯¼å…¥**: ä½¿ç”¨ `from doc_agent.utils.decorators import ...`
3. **ç§»é™¤é‡å¤**: åˆ é™¤åŽŸæœ‰çš„è£…é¥°å™¨å®šä¹‰
4. **æµ‹è¯•éªŒè¯**: ç¡®ä¿åŠŸèƒ½æ­£å¸¸

### å¯¹äºŽæ–°ä»£ç 

ç›´æŽ¥ä½¿ç”¨ç»Ÿä¸€çš„è£…é¥°å™¨æ¨¡å—ï¼š

```python
from doc_agent.utils.decorators import timer, retry, cache_result

@timer
@retry(max_attempts=3)
@cache_result(ttl=600)
def my_function():
    # ä½ çš„å‡½æ•°é€»è¾‘
    pass
```

## ðŸŽ‰ æ€»ç»“

è¿™æ¬¡é‡æž„æˆåŠŸåœ°å°†è£…é¥°å™¨åŠŸèƒ½ä»Ž `web_search.py` ä¸­æå–å‡ºæ¥ï¼Œåˆ›å»ºäº†ä¸€ä¸ªä¸“é—¨çš„è£…é¥°å™¨å·¥å…·æ¨¡å—ã€‚è¿™æ ·åšçš„å¥½å¤„åŒ…æ‹¬ï¼š

1. **æ›´å¥½çš„ä»£ç ç»„ç»‡**: è£…é¥°å™¨é›†ä¸­ç®¡ç†
2. **æé«˜å¤ç”¨æ€§**: å…¶ä»–æ¨¡å—å¯ä»¥è½»æ¾ä½¿ç”¨
3. **å¢žå¼ºåŠŸèƒ½**: æä¾›äº†æ›´å¤šå®žç”¨çš„è£…é¥°å™¨
4. **ä¾¿äºŽç»´æŠ¤**: ç»Ÿä¸€çš„æŽ¥å£å’Œå®žçŽ°

è¿™ç§æ¨¡å—åŒ–çš„è®¾è®¡ç¬¦åˆè½¯ä»¶å·¥ç¨‹çš„æœ€ä½³å®žè·µï¼Œä½¿ä»£ç æ›´åŠ æ¸…æ™°ã€å¯ç»´æŠ¤å’Œå¯æ‰©å±•ã€‚ 